graph LR
    %% Users
    User(["üë§ User"])
    Admin(["üë®‚Äçüíº Administrator"])

    %% Frontend Layer
    subgraph Frontend["üé® Frontend Layer"]
        WebUI["WebUI<br/>Llama-Stack Client"]
    end

    %% Orchestration Layer
    subgraph Orchestration["ü§ñ Orchestration & Agents"]
        direction TB
        Kagenti["Kagenti<br/>K8s Agent Orchestrator"]
        BeeAI["BeeAI Agent<br/>Kagenti CRD<br/>A2A Port: 9999"]
        AgenticBench["Agentic Benchmark<br/>TravelPlanner<br/>VendingBench"]
    end

    %% LLM Inference Layer
    subgraph LLMInference["üöÄ LLM Inference Stack"]
        direction TB
        LlamaStack["LLAMA-STACK Server<br/>Main Orchestrator"]
        KServe["KServe<br/>Model Serving Platform"]
        LlmdScheduler["llm-d Scheduler<br/>Workload Manager"]
        LlmdVLLM["llm-d vLLM<br/>Inference Engine"]
    end

    %% MCP Integration Layer
    subgraph MCPServers["üîå MCP Integration Layer"]
        direction TB
        KuadrantMCP["Kuadrant Gateway<br/>MCP Router"]
        GitHubMCP["GitHub MCP<br/>Source Control"]
        JiraMCP["Jira MCP<br/>Project Mgmt"]
        SearchMCP["Search MCP<br/>Web Search"]
        BenchmarkMCP["Benchmark MCP<br/>Performance"]
    end

    %% Storage Layer
    subgraph Storage["üíæ Data Storage Layer"]
        direction TB
        PgVector["PgVector<br/>Vector Embeddings<br/>HNSW Index"]
        Posgresql["PostgreSQL 17<br/>Primary Database<br/>CloudNativePG"]
    end

    %% Observability Layer
    subgraph Observability["üìä Observability & Monitoring"]
        direction TB
        MLFlow["MLFlow<br/>LLM Trace Collection<br/>Experiment Tracking"]
        VisualMLFlow["Visual MLFlow<br/>TBD - Visualization"]
        GrafanaDash["Grafana<br/>Monitoring Dashboards"]
        OtelPrometheus["OpenTelemetry<br/>+ Prometheus<br/>Metrics Collection"]
    end

    %% External Services
    subgraph External["üåê External Services"]
        direction TB
        Github["GitHub API"]
        Jira["Jira API"]
        BraveSearch["Brave Search API"]
    end

    %% User Interactions
    User -->|"Web Interface"| WebUI
    User -->|"Run Benchmarks"| AgenticBench
    Admin -->|"Monitor"| GrafanaDash

    %% Frontend to Core
    WebUI <-->|"API Calls"| LlamaStack

    %% Orchestration Flow
    AgenticBench -->|"Trigger Tasks"| Kagenti
    Kagenti -->|"Deploy Agents"| BeeAI
    Kagenti -->|"Send Traces"| VisualMLFlow
    BeeAI -->|"LLM Requests"| LlamaStack

    %% LLM Inference Flow
    LlamaStack -->|"Vector Search"| PgVector
    LlamaStack -->|"Store Data"| Posgresql
    LlamaStack -->|"Inference Requests"| KServe
    KServe -->|"Schedule"| LlmdScheduler
    KServe -->|"Execute"| LlmdVLLM
    LlmdScheduler -->|"Assign"| LlmdVLLM

    %% MCP Gateway Integration
    LlamaStack -->|"Tool Calls"| KuadrantMCP
    KuadrantMCP <-->|"Route"| GitHubMCP
    KuadrantMCP <-->|"Route"| JiraMCP
    KuadrantMCP <-->|"Route"| SearchMCP
    KuadrantMCP <-->|"Route"| BenchmarkMCP

    %% External Connections
    GitHubMCP <-->|"REST API"| Github
    JiraMCP <-->|"REST API"| Jira
    SearchMCP <-->|"Search API"| BraveSearch

    %% Observability Flow
    VisualMLFlow -->|"Visualize"| MLFlow
    MLFlow -->|"Store Traces"| Posgresql
    MLFlow <-->|"Collect Traces"| LlamaStack
    OtelPrometheus -->|"Scrape Metrics"| LlamaStack
    OtelPrometheus -->|"Scrape Metrics"| KServe
    GrafanaDash -->|"Query"| OtelPrometheus
    Kagenti -->|"Send Metrics"| MLFlow

    %% Styling with better visibility
    classDef userStyle fill:#4A90E2,stroke:#2E5C8A,stroke-width:3px,color:#fff
    classDef frontendStyle fill:#E8F4F8,stroke:#4A90E2,stroke-width:2px,color:#000
    classDef orchestrationStyle fill:#FFE066,stroke:#CC9900,stroke-width:3px,color:#000
    classDef inferenceStyle fill:#90EE90,stroke:#2D7A2D,stroke-width:3px,color:#000
    classDef storageStyle fill:#E8E8E8,stroke:#666,stroke-width:2px,color:#000
    classDef mcpStyle fill:#DDA0DD,stroke:#8B008B,stroke-width:2px,color:#000
    classDef observabilityStyle fill:#FF6B6B,stroke:#CC0000,stroke-width:3px,color:#fff
    classDef externalStyle fill:#F0F0F0,stroke:#999,stroke-width:2px,color:#000

    class User,Admin userStyle
    class WebUI frontendStyle
    class Kagenti,BeeAI,AgenticBench orchestrationStyle
    class KServe,LlmdScheduler,LlmdVLLM,LlamaStack inferenceStyle
    class PgVector,Posgresql storageStyle
    class KuadrantMCP,GitHubMCP,JiraMCP,SearchMCP,BenchmarkMCP mcpStyle
    class MLFlow,VisualMLFlow,GrafanaDash,OtelPrometheus observabilityStyle
    class Jira,Github,BraveSearch externalStyle
